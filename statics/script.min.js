const DEV="undefined"==typeof IS_PROD,LOG=DEV,BASE_URL=!0===DEV?"http://192.168.5.15":"",BASE_SCRIPT_URL=!0===DEV?BASE_URL+"/script/1/porssi":"",setDebug=dbg=>{debug=dbg?console.log.bind(window.console):()=>{}};setDebug(LOG),window.addEventListener("error",(function(e){console.error("Error at line:",e.lineno)}),!1),window.onload=async()=>{openTab(window.location.hash.substring(window.location.hash.indexOf("#")+1)),await populateDynamicData("content-status.html","#content-status"),await populateDynamicData("content-settings.html","#content-settings"),await populateDynamicData("content-wifi.html","#content-wifi"),await populateDynamicData("content-log.html","#content-log"),await populateDynamicData("content-welcome.html","#content-help")},document.querySelectorAll(".tab-switch").forEach(e=>e.addEventListener("change",e=>{window.location.hash=e.target.id}));const evalContainerScriptTags=elementId=>{debug(me(),"eval running for",elementId);for(var scripts=qs(elementId).querySelectorAll("script"),i=0;i<scripts.length;i++)scripts[i].innerText?eval(scripts[i].innerText):fetch(scripts[i].src).then((function(data){data.text().then((function(r){eval(r)}))})),scripts[i].parentNode.removeChild(scripts[i])},populateDynamicData=async(url,containerId)=>{try{DEV||(url=`${BASE_SCRIPT_URL}?req=${url}`),debug(me(),"fetching",url,"for",containerId);const res=await getData(url,!1);res.success?(qs(containerId).innerHTML=res.data,evalContainerScriptTags(containerId)):qs(containerId).innerHTML=`Error getting data: ${res.statusText}`,debug(me(),"done for",containerId)}catch(err){console.error("populateDynamicData(): Error happened: ",err)}},getData=async(url,isJson=!0)=>{try{const res=await fetch(url);if(res.ok){let data=null;return 204!==res.status&&(data=isJson?await res.json():await res.text()),debug(me(),`Fetching ${url} done. Status code: ${res.status}`),{success:!0,statusCode:res.status,statusText:res.statusText,data:data}}return console.error(`Failed to fetch ${url}: ${res.statusText} (${await res.text()})`),{success:!1,statusCode:res.status,statusText:`Failed to fetch ${url}: ${res.statusText} (${await res.text()})`,data:null}}catch(err){return console.error(`Failed to fetch ${url}: (${JSON.stringify(err)})`),{success:!1,statusCode:-1,statusText:`Failed to fetch ${url}: (${JSON.stringify(err)})`,data:null}}},formatDate=value=>{let date=null;return date="string"==typeof value?new Date(value):value,`${date.getDate().toString().padStart(2,"0")}.${(date.getMonth()+1).toString().padStart(2,"0")}.${date.getFullYear()}`},formatTime=(value,showSeconds=!0,showMilliseconds=!1)=>{let date=null;return date="string"==typeof value?new Date(value):value,`${date.getHours().toString().padStart(2,"0")}:${date.getMinutes().toString().padStart(2,"0")}${showSeconds?`:${date.getSeconds().toString().padStart(2,"0")}`:""}${showMilliseconds?`.${date.getMilliseconds().toString().padStart(3,"0")}`:""}`},formatDateTime=(value,showSeconds=!0,showMilliseconds=!1)=>`${formatDate(value)} ${formatTime(value,showSeconds,showMilliseconds)}`;